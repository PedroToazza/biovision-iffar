<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Biovision IFFar</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/static_biovision/css/style.css">

  <!-- Manifesto do PWA -->
  <link rel="manifest" href="/static_biovision/manifest.json">
  <meta name="theme-color" content="#4CAF50">

  <!-- √çcones -->
  <link rel="icon" href="/static_biovision/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="/static_biovision/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/static_biovision/icons/icon-512.png">
  <script>
  try { if ('scrollRestoration' in history) history.scrollRestoration = 'manual'; } catch(e){}
</script>

</head>
<body>

  
  <div class="app-wrapper">
    <!-- Logo -->
    <header class="topbar">
  <div class="logo-wrapper">
    <img class="logo-img" src="/static_biovision/icons/logo_app.png" alt="Logo Biovision">
  </div>

  <button id="themeToggle" class="theme-toggle" aria-label="Alternar modo escuro" title="Alternar tema">
  <span class="icon">
    <span class="sun" aria-hidden="true">‚òÄÔ∏è</span>
    <span class="moon" aria-hidden="true">üåô</span>
  </span>
</button>
</header>
    <!-- Container principal -->
    <div class="container">
      <h3>Escolha uma imagem para classificar:</h3>

     <div class="upload-box">
  <form id="formGaleria" enctype="multipart/form-data">
    <input type="file" name="imagem" id="imagem" accept="image/*" style="display:none;" onchange="mostrarImagem(this)">
    <button type="button" onclick="document.getElementById('imagem').click()">Selecionar imagem</button>
  </form>

  <div id="imagemPreview" style="display:none;">
    <h3>Imagem Selecionada:</h3>
    <img id="previewImagem" src="" alt="Imagem da Esp√©cie"/>
  </div>

  <button type="button" id="btnIdentificar" style="display:none;">Iniciar identifica√ß√£o</button>

  <div id="loading" class="loading" role="status" aria-live="polite" style="display:none;">
    <div class="spinner" aria-hidden="true"></div>
    <p>Identificando esp√©cie e buscando dados...</p>
  </div>
</div>


      <!-- Resultado -->
      <div id="resultado"></div>
    </div>

    <!-- Modal de zoom -->
    <div id="zoomModal" class="zoom-modal">
      <div class="zoom-content" id="zoomContent"></div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="/static_biovision/js/app.js"></script>

  <script>
    // Registrar o Service Worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/service-worker.js")
        .then(reg => console.log("Service Worker registrado:", reg))
        .catch(err => console.error("Erro ao registrar Service Worker:", err));
    }

    // Mostrar instru√ß√µes de instala√ß√£o (iOS + Android simplificado) ‚Äî s√≥ se existir o elemento
    const installInstructions = document.getElementById("installInstructions");
    if (installInstructions) {
      const isIOS = /iphone|ipad|ipod/i.test(window.navigator.userAgent);
      const isInStandalone = window.navigator.standalone === true;
      if ((isIOS && !isInStandalone) || (!isIOS && !window.matchMedia('(display-mode: standalone)').matches)) {
        installInstructions.style.display = "block";
      }
    }

    // Sempre come√ßar no topo ao carregar/recarregar a p√°gina
    window.onbeforeunload = function () { window.scrollTo(0, 0); };
    window.addEventListener("load", () => { window.scrollTo({ top: 0, left: 0, behavior: "instant" }); });

    // Abrir seletor de arquivo
    document.getElementById("btnSelecionar").addEventListener("click", () => {
      document.getElementById("imagem").click();
    });
  </script>
</body>
</html>
